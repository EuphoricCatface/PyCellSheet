PyCellSheet Changelog
=====================

Base upstream: pyspread 2.3.1 (forked November 2024)

v0.3.0
------

Summary:
- 29 files changed, 1717 insertions, 1403 deletions

Features:
- Added multi-version test gate support (`tox` matrix + CI workflow + runbook).
- Hardened Sheet Script draft lifecycle behavior for save/new/open/quit transitions.

Fixes:
- Improved release-line docs consistency for active development status, baseline policy references, and release-note/test guidance alignment.

Tests:
- Expanded baseline test contracts for expression-parser modes, slice-migration compatibility, and macro/sheet-script alias parity.
- Added targeted workflow coverage for save/open/sign-file branches, including trusted-load and save-fallback paths.
- Added focused runtime contracts for `HelpText`, `Formatter`, `RangeOutput`, and `CELL_META_GENERATOR`.
- Added deterministic utility-path coverage for grid renderer (`painter_rotate`, `EdgeBorders.color`, `QColorCache`).
- Added non-interactive dialog branch coverage for choice mapping and `DataEntryDialog` validation/data paths.
- Current branch baseline passes on active interpreter (`830 passed`).

Maintenance:
- Added CI gate runbook linkage and release-engineering notes to reduce drift between process docs and shipped behavior.

v0.2.0
-----------------------

Summary:
- 37 files changed, 1610 insertions, 180 deletions

Features:
- Improved recalc UX baseline with clearer status feedback and dirty-indicator rendering consistency.
- Expanded sheet-script workflow behavior: apply-all execution at workflow boundaries, trusted/untrusted load handling, and safe-mode approval path consistency.

Fixes:
- Stabilization pass for dependency/recalculation behavior, including dynamic-reference dependency correctness and transitive dependency traversal hardening.
- Save/load robustness improvements for sheet names and per-sheet script headers, including stricter parsing/normalization and round-trip coverage.
- Terminology and UI consistency cleanup around `Sheet Script` and `Tools -> Macro` paths in user-facing docs/UI touchpoints.

Tests:
- Broader stabilization test coverage across dependency integration, workflows, dirty-indicator rendering, and `.pycs` sheet-name/script edge cases.

Maintenance:
- Codebase hygiene updates: inline-import cleanup in touched paths and attribution/GPL header normalization for user-created modules.

v0.1.0
------

Summary:
- 61 files changed, 6415 insertions, 1628 deletions

Highlights:
- Added dependency-aware recalculation core with `DependencyGraph` and `SmartCache`.
- Added circular reference detection and new PyCellSheet exceptions.
- Added dirty-state UI integration and refresh icon rendering in cells.
- Added named sheet support and sheet rename functionality.
- Expanded spreadsheet function coverage across math/statistical/filter/info/engineering modules.
- Added/updated tests for dependency graph, smart cache, reference parsing, and integration flows.
- Removed frozen-cell and evaluation-timeout features from core, UI, and settings.
- Refined evaluation/runtime behavior (globals isolation, parser fixes, cache correctness, coordinate-order fixes).
- UI/UX cleanup: recalculate actions moved under Tools, "Macro panel" renamed to "Sheet Script", and macro/spell-check actions grouped under Tools.
- Final hardening pass: dependency refresh correctness fixes, undoable sheet rename, robust sheet-script header parsing, transitive-closure caching, and Python 3.11 compatibility fix.
- Logging cleanup and additional debug logging around dependency/caching operations.

v0.0.5 Proof-of-Concept
-----------------------

Summary:
- 35 files changed, 3607 insertions, 1106 deletions

Highlights:
- Forked from pyspread 2.3.1 and established PyCellSheet direction.
- Implemented copy-priority semantics with core types (`EmptyCell`, `PythonCode`, `Range`, `RangeOutput`).
- Introduced expression parsing modes and initial reference parser implementation.
- Implemented per-sheet init scripts and `.pycs` file-format workflow.
- Added spreadsheet helper functions (`C`, `R`, `Sh`, `CR`, `G`) and `HelpText`.
- Built initial spreadsheet-function library structure and early implementations.
- Added design documentation and initial UI wiring for sheet script editing.
